<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Admin Panel - KuGuider</title>
<link rel="icon" href="file_0000000042b861fd808de615ad3ddea5.png" type="image/png">
<link href="https://fonts.googleapis.com/css2?family=Poppins&display=swap" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet"/>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"/>

<style>
  *{margin:0;padding:0;box-sizing:border-box;font-family:'Poppins',sans-serif;}
  body{background:#0d0d0d;color:#fff;transition:0.3s;}
  header{text-align:center;padding:2rem 1rem 3rem;}
  .header-img{width:200px;height:100px;object-fit:cover;border-radius:10%;margin-bottom:1rem;}

  nav{
    display:flex;justify-content:center;gap:0.7rem;
    padding:0.4rem 0.6rem;flex-wrap:wrap;background:#111;
  }
  nav a{
    display:flex;align-items:center;gap:0.3rem;
    padding:0.7rem 0.9rem;border-radius:10px;color:#000;
    background:#fff;text-decoration:none;font-size:0.9rem;
    transition:0.3s;
  }

  .logout-btn{background:#f44336 !important;color:#fff !important;}
  .logout-btn .material-icons{color:#fff !important;}

  /* Cards */
  .container{
    padding:2rem 1rem;
    display:grid;
    grid-template-columns:repeat(auto-fit,minmax(250px,1fr));
    gap:1.5rem;
  }

  .card{
    background:#111;padding:1.5rem;border-radius:12px;
    transition:0.3s;
  }
  .card:hover{background:#1a1a1a;transform:translateY(-4px);}
  .card h2{margin-bottom:0.5rem;font-size:1.1rem;}
  .card p{font-size:0.9rem;color:#bbb;margin-bottom:10px;}
  .btn{
    background:#fff;color:#000;border:none;padding:0.6rem 1.2rem;
    border-radius:8px;cursor:pointer;transition:0.3s;font-weight:500;
  }

  /* Modal */
  .modal{
    position:fixed;top:0;left:0;width:100%;height:100%;
    background:rgba(0,0,0,0.6);display:none;justify-content:center;
    align-items:center;z-index:10000;
  }
  .modal-content{
    background:#111;padding:2rem;width:90%;max-width:500px;
    border-radius:12px;
  }
  .modal-content input,.modal-content textarea,.modal-content select{
    width:100%;padding:0.7rem;margin-bottom:1rem;border-radius:8px;
    border:none;background:#222;color:#fff;
  }

  /* Alert */
  .custom-alert{
    position:fixed;top:15px;left:50%;width:270px;transform:translateX(-50%);
    background:#333;color:#fff;padding:1rem;border-radius:10px;
    display:none;align-items:center;justify-content:space-around;
    z-index:9999;
  }

  footer{background:#111;color:#aaa;text-align:center;padding:1rem;margin-top:2rem;}
</style>
</head>

<body>

<header>
  <img src="/file_0000000042b861fd808de615ad3ddea5.png" class="header-img"/>
</header>

<nav>
  <a href="dashboard.html" class="active"><span class="material-icons">dashboard</span>Dashboard</a>
  <a href="editnotes.html"><span class="material-icons">note_add</span>Notes</a>
  <a href="editpapers.html"><span class="material-icons">description</span>Papers</a>
  <a href="#" class="logout-btn" onclick="logoutUser()"><span class="material-icons">logout</span>Logout</a>
</nav>

<section class="container">

  <div class="card">
    <h2>Notes Management</h2>
    <p>Add Notes</p>
    <button class="btn" onclick="document.getElementById('notesModal').style.display='flex'">Manage Notes</button>
  </div>

  <div class="card">
    <h2>Papers Management</h2>
    <p>Upload Papers</p>
    <button class="btn" onclick="document.getElementById('papersModal').style.display='flex'">Manage Papers</button>
  </div>

  <div class="card">
    <h2>Homepage Popup</h2>
    <p>Edit homepage popup text</p>
    <button class="btn" onclick="document.getElementById('popupModal').style.display='flex'">Edit Popup</button>
  </div>

</section>

<!-- Notes Modal -->
<div class="modal" id="notesModal">
  <div class="modal-content">
    <h3>Add Note</h3>
    <input id="noteSubject" placeholder="Subject Name"/>
    <select id="noteSemester">
      <option value="">-- Select Semester --</option>
      <option>Semester 1</option><option>Semester 2</option>
      <option>Semester 3</option><option>Semester 4</option>
      <option>Semester 5</option><option>Semester 6</option>
    </select>
    <input id="noteURL" placeholder="File URL"/>

    <button class="btn" onclick="submitNote()">Submit</button>
    <button class="btn" style="background:#444;color:#fff;margin-top:10px"
      onclick="document.getElementById('notesModal').style.display='none'">Cancel</button>
  </div>
</div>

<!-- Papers Modal -->
<div class="modal" id="papersModal">
  <div class="modal-content">
    <h3>Add Paper</h3>
    <input id="paperTitle" placeholder="Paper Title"/>
    <select id="paperSemester">
      <option value="">-- Select Semester --</option>
      <option>Semester 1</option><option>Semester 2</option><option>Semester 3</option>
      <option>Semester 4</option><option>Semester 5</option><option>Semester 6</option>
    </select>
    <input id="paperURL" placeholder="File URL"/>

    <button class="btn" onclick="submitPaper()">Submit</button>
    <button class="btn" style="background:#444;color:#fff;margin-top:10px"
      onclick="document.getElementById('papersModal').style.display='none'">Cancel</button>
  </div>
</div>

<!-- Popup Modal -->
<div class="modal" id="popupModal">
  <div class="modal-content">
    <h3 style="margin-bottom:5px;">Popup Editor</h3>

    <input id="popupTitleInput" placeholder="Popup Title">
    <textarea id="popupMessageInput" placeholder="Popup Message" rows="3"></textarea>

    <select id="popupEnabledInput">
      <option value="true">Enabled</option>
      <option value="false">Disabled</option>
    </select>

    <div class="actions">
      <button class="btn" onclick="savePopup()">Save Popup</button>
      <button class="btn" style="background:#444;color:#fff"
        onclick="document.getElementById('popupModal').style.display='none'">Cancel</button>
    </div>
  </div>
</div>

<div class="custom-alert" id="logoutAlert"><i class="fas fa-circle-info"></i><span></span></div>
<footer>Made with ❤️ by <span>Basif Shafi Wani</span></footer>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>

<script>
const firebaseConfig={
  apiKey:"AIzaSyBmbFYqpuqaWCxmh7VqKTb_8CUvyEohzbw",
  authDomain:"kuguider.firebaseapp.com",
  projectId:"kuguider",
  storageBucket:"kuguider.appspot.com",
  messagingSenderId:"483181223164",
  appId:"1:483181223164:web:e35d8ace05364b4d2d8b79"
};
firebase.initializeApp(firebaseConfig);
const db=firebase.firestore();

firebase.auth().onAuthStateChanged(u=>{
  if(!u){ showAlert("Unauthorized access!"); setTimeout(()=>location.href="login-admin.html",1000); }
});

function showAlert(msg){
  const box=document.getElementById("logoutAlert");
  box.querySelector("span").innerText=msg;
  box.style.display="flex";
  setTimeout(()=>box.style.display="none",1000);
}

function logoutUser(){
  firebase.auth().signOut().then(()=>{
    showAlert("Logged out!");
    setTimeout(()=>location.href="/login-admin.html",1000);
  });
}

function submitNote(){
  const s=document.getElementById("noteSubject").value;
  const sem=document.getElementById("noteSemester").value;
  const url=document.getElementById("noteURL").value;
  if(!s||!sem||!url) return showAlert("All fields required");

  db.collection("notes").add({
    subject:s, semester:sem, fileURL:url,
    fileName:url.split("/").pop(),
    uploadedAt:firebase.firestore.FieldValue.serverTimestamp()
  }).then(()=>{
    showAlert(" Note Added Successfully!");
    document.getElementById('notesModal').style.display='none';
  });
}

function submitPaper(){
  const t=document.getElementById("paperTitle").value;
  const sem=document.getElementById("paperSemester").value;
  const url=document.getElementById("paperURL").value;
  if(!t||!sem||!url) return showAlert("All fields required");

  db.collection("papers").add({
    title:t, semester:sem, fileURL:url,
    fileName:url.split("/").pop(),
    uploadedAt:firebase.firestore.FieldValue.serverTimestamp()
  }).then(()=>{
    showAlert(" Paper Added Successfully!");
    document.getElementById('papersModal').style.display='none';
  });
}

function loadPopup(){
  db.collection("popup").doc("homepage").get().then(doc=>{
    if(doc.exists){
      const d=doc.data();
      document.getElementById("popupTitleInput").value=d.title||"";
      document.getElementById("popupMessageInput").value=d.message||"";
      document.getElementById("popupEnabledInput").value=d.enabled?"true":"false";
    }
  });
}
loadPopup();

function savePopup(){
  const t=document.getElementById("popupTitleInput").value;
  const m=document.getElementById("popupMessageInput").value;
  const e=document.getElementById("popupEnabledInput").value==="true";

  db.collection("popup").doc("homepage").set({
    title:t, message:m, enabled:e
  }).then(()=>{
    showAlert(" Popup Updated Successfully!");
    document.getElementById("popupModal").style.display="none";
  });
}
</script>

</body>
</html>